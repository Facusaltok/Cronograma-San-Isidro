# Write the edited HTML with an extra "Chofer de Apoyo" column next to AMT in the Turnos table.
html = r"""<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cronograma San Isidro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #1a3b5d;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --morning: #e3f2fd;
            --night: #e8eaf6;
            --special: #e8f5e9;
            --refuerzo: #fff3e0;
            --border: #dee2e6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
            padding: 15px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 25px;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .action-buttons {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-primary {
            background-color: white;
            color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: #f0f0f0;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .legend {
            background-color: var(--light);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .legend h2 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        
        .color-box {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border-radius: 3px;
            border: 1px solid #ddd;
        }
        
        .content {
            padding: 20px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
        }
        
        .tab:hover {
            color: var(--secondary);
        }
        
        .tab.active {
            color: var(--secondary);
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--secondary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .sub-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            background-color: var(--light);
            padding: 0 10px;
            border-radius: 6px 6px 0 0;
        }
        
        .sub-tab {
            padding: 8px 16px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--dark);
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
            border-bottom: 2px solid transparent;
        }
        
        .sub-tab:hover {
            color: var(--secondary);
        }
        
        .sub-tab.active {
            color: var(--secondary);
            border-bottom-color: var(--secondary);
            background-color: white;
            margin: 0 -10px;
            padding: 8px 26px;
        }
        
        .sub-tab-content {
            display: none;
        }
        
        .sub-tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 6px;
            border: 1px solid var(--border);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
            font-size: 0.9rem;
        }
        
        th {
            background-color: var(--primary);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .turno-ma침ana { background-color: var(--morning); }
        .turno-noche  { background-color: var(--night); }
        .turno-especial { background-color: var(--special); }
        .turno-refuerzo { background-color: var(--refuerzo); }
        
        .editable {
            cursor: text;
            position: relative;
            padding: 8px;
            border-radius: 3px;
            transition: background-color 0.3s;
        }
        
        .editable:hover { background-color: rgba(52, 152, 219, 0.1); }
        .editable:focus { outline: 2px solid var(--secondary); background-color: white; }
        
        .status {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        .status-disponible   { background-color: rgba(39,174,96,.15); color: var(--success); }
        .status-parcial      { background-color: rgba(243,156,18,.15); color: var(--warning); }
        .status-no-disponible{ background-color: rgba(231,76,60,.15); color: var(--accent); }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .card { background:#fff; border-radius:6px; padding:15px; box-shadow:0 2px 6px rgba(0,0,0,.06); border-left:4px solid var(--secondary); }
        .card h3 { color: var(--primary); margin-bottom:10px; font-size:1rem; }
        .card-value { font-size:1.8rem; font-weight:700; color: var(--secondary); margin-bottom:5px; }
        .card-desc { color:#7f8c8d; font-size:.85rem; }
        
        .notes { background-color:#fff8e1; border-left:4px solid #ffb300; padding:12px 15px; margin-top:20px; border-radius:0 6px 6px 0; }
        .notes h3 { color:#e65100; margin-bottom:8px; font-size:1.1rem; }
        .notes ul { padding-left:20px; }
        .notes li { margin-bottom:6px; font-size:.9rem; }
        
        .alert { padding:10px 15px; margin:15px 0; border-radius:6px; font-size:.9rem; }
        .alert-warning { background-color:#fff3cd; border-left:4px solid #ffc107; color:#856404; }
        .alert-danger  { background-color:#f8d7da; border-left:4px solid #dc3545; color:#721c24; }
        
        .edit-mode { background-color:#f0f8ff; border:1px dashed var(--secondary); }
        
        .turno-subheader { background-color:#f1f3f5; font-weight:600; font-size:.85rem; color:var(--dark); }
        .custodia-header { background-color: var(--primary); color:white; font-weight:600; text-align:center; font-size:.85rem; padding:8px; }
        
        @media (max-width: 768px) {
            .container { margin:5px; border-radius:0; }
            header { padding:15px 10px; }
            h1 { font-size:1.5rem; }
            .action-buttons { position:static; transform:none; justify-content:center; margin-top:10px; }
            .content { padding:15px 10px; }
            .tabs { flex-wrap:wrap; }
            .tab { padding:8px 12px; font-size:.85rem; }
            .sub-tabs { flex-wrap:wrap; }
            .sub-tab { padding:6px 12px; font-size:.8rem; }
            th, td { padding:8px 10px; font-size:.85rem; }
            .legend-grid { grid-template-columns:1fr; }
            .summary-cards { grid-template-columns:1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Cronograma San Isidro</h1>
            <div class="subtitle">San Isidro</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="toggleEditMode()">
                    <span id="edit-icon">九勇</span> <span id="edit-text">Editar</span>
                </button>
                <button class="btn btn-success" onclick="exportToPDF()">
                    游늯 Exportar PDF
                </button>
            </div>
        </header>
        
        <section class="legend">
            <h2>San Isidro</h2>
            <div class="legend-grid">
                <div class="legend-item">
                    <div class="color-box" style="background-color: var(--morning);"></div>
                    <div><strong>Turno Ma침ana:</strong> 07:00 - 19:00</div>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background-color: var(--night);"></div>
                    <div><strong>Turno Noche:</strong> 19:00 - 07:00</div>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background-color: var(--special);"></div>
                    <div><strong>AMT:</strong> 08:00 - 20:00</div>
                </div>
                <div class="legend-item">
                    <div class="color-box" style="background-color: var(--refuerzo);"></div>
                    <div><strong>Chofer de Apoyo:</strong> Refuerzos</div>
                </div>
            </div>
        </section>
        
        <div class="content" id="content-to-export">
            <div class="tabs">
                <button class="tab active" onclick="openTab(event, 'turnos')">Turnos Diarios</button>
                <button class="tab" onclick="openTab(event, 'choferes')">Choferes Custodia</button>
                <button class="tab" onclick="openTab(event, 'personal')">Detalles por Personal</button>
                <button class="tab" onclick="openTab(event, 'resumen')">Resumen de Cobertura</button>
            </div>
            
            <div id="turnos" class="tab-content active">
                <div class="alert alert-warning">
                    <strong>Atenci칩n:</strong> Los d칤as 17-30 tienen asignaciones pendientes. Por favor, actualizar.
                </div>
                
                <div class="table-container">
                    <table id="turnos-table">
                        <thead>
                            <tr>
                                <th rowspan="2">D칤a</th>
                                <th rowspan="2">Fecha</th>
                                <th colspan="2" style="text-align: center;">Turno Ma침ana (07:00-19:00)</th>
                                <th colspan="2" style="text-align: center;">Turno Noche (19:00-07:00)</th>
                                <th rowspan="2">AMT (08:00-20:00)</th>
                                <th rowspan="2">Chofer de Apoyo</th>
                            </tr>
                            <tr>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Los datos se cargar치n din치micamente desde JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="choferes" class="tab-content">
                <div class="alert alert-warning">
                    <strong>Atenci칩n:</strong> Verificar asignaciones de choferes para las 4 custodias.
                </div>
                
                <div class="table-container">
                    <table id="choferes-table">
                        <thead>
                            <tr>
                                <th rowspan="2">D칤a</th>
                                <th rowspan="2">Fecha</th>
                                <th colspan="4" style="text-align: center;">CUSTODIAS</th>
                            </tr>
                            <tr>
                                <th class="custodia-header">CUSTODIA 1<br>(SRA. AMALIA)</th>
                                <th class="custodia-header">CUSTODIA 2<br>(ISABELLA)</th>
                                <th class="custodia-header">CUSTODIA 3<br>(ANGELINA)</th>
                                <th class="custodia-header">CUSTODIA 4<br>(VALENTINO)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Los datos se cargar치n din치micamente desde JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="personal" class="tab-content">
                <div class="sub-tabs">
                    <button class="sub-tab active" onclick="openSubTab(event, 'personal-cabina')">Personal Cabina y AMT</button>
                    <button class="sub-tab" onclick="openSubTab(event, 'personal-choferes')">Personal Choferes Custodia</button>
                </div>
                
                <div id="personal-cabina" class="sub-tab-content active">
                    <div class="table-container">
                        <table id="personal-cabina-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Jerarqu칤a</th>
                                    <th>ORDINARIO</th>
                                    <th>Disponibilidad</th>
                                    <th>OBSERVACIONES</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Los datos se cargar치n din치micamente desde JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="personal-choferes" class="sub-tab-content">
                    <div class="table-container">
                        <table id="personal-choferes-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Jerarqu칤a</th>
                                    <th>ORDINARIO</th>
                                    <th>Disponibilidad</th>
                                    <th>OBSERVACIONES</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Los datos se cargar치n din치micamente desde JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div id="resumen" class="tab-content">
                <div class="summary-cards">
                    <div class="card">
                        <h3>D칤as Totales</h3>
                        <div class="card-value">30</div>
                        <div class="card-desc">D칤as en el mes de septiembre</div>
                    </div>
                    <div class="card">
                        <h3>Cobertura Promedio</h3>
                        <div class="card-value">92%</div>
                        <div class="card-desc">Porcentaje de d칤as cubiertos</div>
                    </div>
                    <div class="card">
                        <h3>Personal Activo</h3>
                        <div class="card-value">15</div>
                        <div class="card-desc">Personal disponible este mes</div>
                    </div>
                    <div class="card">
                        <h3>Incidencias</h3>
                        <div class="card-value">3</div>
                        <div class="card-desc">D칤as con cobertura parcial</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="coverage-table">
                        <thead>
                            <tr>
                                <th>Semana</th>
                                <th>D칤as Cubiertos</th>
                                <th>Incidentes</th>
                                <th>Acciones Requeridas</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Los datos se cargar치n din치micamente desde JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="notes">
                    <h3>Novedades Importantes</h3>
                    <ul id="important-notes">
                        <!-- Las notas se cargar치n din치micamente desde JavaScript -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos completos para todos los d칤as de septiembre 2025
        const turnosData = [
            { dia:"Lunes",     fecha:1,  ma침ana1:"SEQUEIRA",  ma침ana2:"LOVERA",   noche1:"OJEDA",    noche2:"ORTIZ",    especial:"LOBO",            apoyo:"",           supervisor:"SCARSO" },
            { dia:"Martes",    fecha:2,  ma침ana1:"SCARSO",    ma침ana2:"RODRIGUEZ",noche1:"VEIGA",    noche2:"VIZGARRA",especial:"ATENCIO, CIRIGLIANO", apoyo:"", supervisor:"LOBO" },
            { dia:"Mi칠rcoles", fecha:3,  ma침ana1:"COCUCCI",   ma침ana2:"LOVERA",   noche1:"MANSILLA", noche2:"ORTIZ",    especial:"DE LEONIBUS",     apoyo:"",           supervisor:"VIZGARRA" },
            { dia:"Jueves",    fecha:4,  ma침ana1:"SEQUEIRA",  ma침ana2:"ATENCIO",  noche1:"OJEDA",    noche2:"RODRIGUEZ",especial:"LOBO, CIRIGLIANO", apoyo:"", supervisor:"LOPEZ" },
            { dia:"Viernes",   fecha:5,  ma침ana1:"VEIGA",     ma침ana2:"LOVERA",   noche1:"COCUCCI",  noche2:"OJEDA",    especial:"GONZALEZ L",      apoyo:"",           supervisor:"DE LEONIBUS" },
            { dia:"S치bado",    fecha:6,  ma침ana1:"VIZGARRA",  ma침ana2:"MANSILLA", noche1:"VEIGA",    noche2:"",         especial:"DE LEONIBUS",     apoyo:"",           supervisor:"SEQUEIRA" },
            { dia:"Domingo",   fecha:7,  ma침ana1:"VIZGARRA",  ma침ana2:"COCUCCI",  noche1:"OJEDA",    noche2:"RODRIGUEZ",especial:"LOBO",             apoyo:"",           supervisor:"MANSILLA" },
            { dia:"Lunes",     fecha:8,  ma침ana1:"SEQUEIRA",  ma침ana2:"SCARSO",   noche1:"VEIGA",    noche2:"LOPEZ",    especial:"ATENCIO, CIRIGLIANO", apoyo:"", supervisor:"CIRIGLIANO" },
            { dia:"Martes",    fecha:9,  ma침ana1:"COCUCCI",   ma침ana2:"LOVERA",   noche1:"MANSILLA", noche2:"ORTIZ",    especial:"DE LEONIBUS",     apoyo:"",           supervisor:"RODRIGUEZ" },
            { dia:"Mi칠rcoles", fecha:10, ma침ana1:"SCARSO",    ma침ana2:"SEQUEIRA", noche1:"LOPEZ",    noche2:"RODRIGUEZ",especial:"LOBO, CIRIGLIANO", apoyo:"", supervisor:"COCUCCI" },
            { dia:"Jueves",    fecha:11, ma침ana1:"COCUCCI",   ma침ana2:"VEIGA",    noche1:"VIZGARRA", noche2:"ORTIZ",    especial:"GONZALEZ L",      apoyo:"",           supervisor:"OJEDA" },
            { dia:"Viernes",   fecha:12, ma침ana1:"ATENCIO",   ma침ana2:"MANSILLA", noche1:"ALEGRE",   noche2:"VEIGA",    especial:"DE LEONIBUS, CIRIGLIANO", apoyo:"", supervisor:"VEIGA" },
            { dia:"S치bado",    fecha:13, ma침ana1:"SEQUEIRA",  ma침ana2:"VIZGARRA", noche1:"RODRIGUEZ",noche2:"LOPEZ",    especial:"LOBO",             apoyo:"",           supervisor:"ALEGRE" },
            { dia:"Domingo",   fecha:14, ma침ana1:"SCARSO",    ma침ana2:"ORTIZ",    noche1:"VEIGA",    noche2:"ALEGRE",   especial:"ATENCIO",          apoyo:"",           supervisor:"ATENCIO" },
            { dia:"Lunes",     fecha:15, ma침ana1:"COCUCCI",   ma침ana2:"LOVERA",   noche1:"MANSILLA", noche2:"ORTIZ",    especial:"DE LEONIBUS",      apoyo:"",           supervisor:"ORTIZ" },
            { dia:"Martes",    fecha:16, ma침ana1:"SEQUEIRA",  ma침ana2:"SCARSO",   noche1:"LOPEZ",    noche2:"ALEGRE",   especial:"LOBO, CIRIGLIANO", apoyo:"", supervisor:"LOVERA" },
            { dia:"Mi칠rcoles", fecha:17, ma침ana1:"COCUCCI",   ma침ana2:"LOVERA",   noche1:"VEIGA",    noche2:"ORTIZ",    especial:"154",              apoyo:"",           supervisor:"Por asignar" },
            { dia:"Jueves",    fecha:18, ma침ana1:"LOPEZ",     ma침ana2:"ATENCIO",  noche1:"ALEGRE",   noche2:"RODRIGUEZ",especial:"CIRIGLIANO",       apoyo:"",           supervisor:"Por asignar" },
            { dia:"Viernes",   fecha:19, ma침ana1:"SEQUEIRA",  ma침ana2:"MANSILLA", noche1:"LOVERA",   noche2:"ORTIZ",    especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"S치bado",    fecha:20, ma침ana1:"SCARSO",    ma침ana2:"VIZGARRA", noche1:"VEIGA",    noche2:"ALEGRE",   especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Domingo",   fecha:21, ma침ana1:"MANSILLA",  ma침ana2:"ORTIZ",    noche1:"VIZGARRA", noche2:"ALEGRE",   especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Lunes",     fecha:22, ma침ana1:"LOPEZ",     ma침ana2:"RODRIGUEZ",noche1:"OJEDA",    noche2:"SCARSO",   especial:"CIRIGLIANO",       apoyo:"",           supervisor:"Por asignar" },
            { dia:"Martes",    fecha:23, ma침ana1:"COCUCCI",   ma침ana2:"LOVERA",   noche1:"VEIGA",    noche2:"OJEDA",    especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Mi칠rcoles", fecha:24, ma침ana1:"LOPEZ",     ma침ana2:"ATENCIO",  noche1:"MANSILLA", noche2:"SCARSO",   especial:"CIRIGLIANO",       apoyo:"",           supervisor:"Por asignar" },
            { dia:"Jueves",    fecha:25, ma침ana1:"SEQUEIRA",  ma침ana2:"LOVERA",   noche1:"OJEDA",    noche2:"VIZGARRA", especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Viernes",   fecha:26, ma침ana1:"LOPEZ",     ma침ana2:"RODRIGUEZ",noche1:"ALEGRE",   noche2:"SCARSO",   especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"S치bado",    fecha:27, ma침ana1:"COCUCCI",   ma침ana2:"RODRIGUEZ",noche1:"MANSILLA", noche2:"VIZGARRA", especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Domingo",   fecha:28, ma침ana1:"SCARSO",    ma침ana2:"ORTIZ",    noche1:"ALEGRE",   noche2:"OJEDA",    especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Lunes",     fecha:29, ma침ana1:"SEQUEIRA",  ma침ana2:"LOVERA",   noche1:"OJEDA",    noche2:"COCUCCI",  especial:"Por asignar",      apoyo:"",           supervisor:"Por asignar" },
            { dia:"Martes",    fecha:30, ma침ana1:"LOPEZ",     ma침ana2:"ATENCIO",  noche1:"MANSILLA", noche2:"ALEGRE",   especial:"CIRIGLIANO",       apoyo:"",           supervisor:"Por asignar" }
        ];

        const choferesData = [
            { dia:"Lunes",     fecha:1,  custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"ACOSTA" },
            { dia:"Martes",    fecha:2,  custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"FURFARO" },
            { dia:"Mi칠rcoles", fecha:3,  custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"CARRE칌O",  custodia4:"ACOSTA" },
            { dia:"Jueves",    fecha:4,  custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"ACEVEDO" },
            { dia:"Viernes",   fecha:5,  custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CHARON",   custodia4:"ACOSTA" },
            { dia:"S치bado",    fecha:6,  custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"CARRE칌O",  custodia4:"ACEVEDO" },
            { dia:"Domingo",   fecha:7,  custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"ACEVEDO" },
            { dia:"Lunes",     fecha:8,  custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CHARON",   custodia4:"FURFARO" },
            { dia:"Martes",    fecha:9,  custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"CARRE칌O",  custodia4:"ACOSTA" },
            { dia:"Mi칠rcoles", fecha:10, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"FURFARO" },
            { dia:"Jueves",    fecha:11, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CHARON",   custodia4:"ACOSTA" },
            { dia:"Viernes",   fecha:12, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"CARRE칌O",  custodia4:"ACEVEDO" },
            { dia:"S치bado",    fecha:13, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"FURFARO" },
            { dia:"Domingo",   fecha:14, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"FURFARO" },
            { dia:"Lunes",     fecha:15, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"ACOSTA" },
            { dia:"Martes",    fecha:16, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"NARVAEZ",  custodia4:"FURFARO" },
            { dia:"Mi칠rcoles", fecha:17, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"ACOSTA" },
            { dia:"Jueves",    fecha:18, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"ACEVEDO" },
            { dia:"Viernes",   fecha:19, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"NARVAEZ",  custodia4:"ACOSTA" },
            { dia:"S치bado",    fecha:20, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"ACEVEDO" },
            { dia:"Domingo",   fecha:21, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"ACEVEDO" },
            { dia:"Lunes",     fecha:22, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"CHARON",   custodia4:"FURFARO" },
            { dia:"Martes",    fecha:23, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"ACOSTA" },
            { dia:"Mi칠rcoles", fecha:24, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"ACEVEDO" },
            { dia:"Jueves",    fecha:25, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"NARVAEZ",  custodia4:"ACOSTA" },
            { dia:"Viernes",   fecha:26, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CHARON",   custodia4:"ACEVEDO" },
            { dia:"S치bado",    fecha:27, custodia1:"PAZ",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"FURFARO" },
            { dia:"Domingo",   fecha:28, custodia1:"ALMIRON",   custodia2:"ROBLEDO",  custodia3:"NARVAEZ",  custodia4:"FURFARO" },
            { dia:"Lunes",     fecha:29, custodia1:"FERNANDEZ", custodia2:"FERRER",   custodia3:"CARRE칌O",  custodia4:"ACOSTA" },
            { dia:"Martes",    fecha:30, custodia1:"Paz",       custodia2:"PIANELLI", custodia3:"NARVAEZ",  custodia4:"ACEVEDO" }
        ];

        const personalCabinaData = [
            { nombre:"SCARSO",     jerarquia:"Subinspector",       guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir d칤as pares. No disponible: 7, 27. Licencia: 29/09 - 06/10." },
            { nombre:"LOBO",       jerarquia:"Subinspector",       guardias:"24x48",       disponibilidad:"disponible", notas:"D칤as: 2,5,8,11,14,17,20,23,26,29. El 18 solo noche." },
            { nombre:"VIZGARRA",   jerarquia:"Ayudante",           guardias:"D칤a/Noche",   disponibilidad:"parcial",    notas:"D칤a/Noche: 6,7,13,14,20,21,27,28. Solo noche: 4,5,11,12,18,19,25,26,29,30. Cursa L, M, M." },
            { nombre:"LOVERA",     jerarquia:"Ayudante",           guardias:"12x36",       disponibilidad:"disponible", notas:"Puede cubrir de noche. 6 y 7 no. Curso instructor de tiro de d칤a." },
            { nombre:"COCUCCI",    jerarquia:"Ayudante",           guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir: 07-19h: 2,6,8,10,14,18,22,26,27. 19-07h: 2,4,7,13,18,26,28." },
            { nombre:"ORTIZ",      jerarquia:"Agente",             guardias:"12x36",       disponibilidad:"disponible", notas:"Puede cubrir de noche. 6 y 7 no. Curso instructor de tiro de d칤a." },
            { nombre:"OJEDA",      jerarquia:"Cabo 1춿",            guardias:"24x48",       disponibilidad:"disponible", notas:"Guardias: 03-06-21-24-27 y 30. L/A del 08 al 20/09." },
            { nombre:"VEIGA",      jerarquia:"Cabo 1춿",            guardias:"24x48",       disponibilidad:"disponible", notas:"Guardias: 1,4,7,10,13,16,19,22. L/A del 25 al 01/10." },
            { nombre:"ATENCIO",    jerarquia:"Cabo",               guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir pares. No el 7-10-13." },
            { nombre:"RODRIGUEZ",  jerarquia:"Sargento",           guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir pares. No el 1,4." },
            { nombre:"DE LEONIBUS",jerarquia:"Suboficial Auxiliar",guardias:"24x48",       disponibilidad:"disponible", notas:"Guardias: 2-5-8-11-14-17-20-23-26-29." },
            { nombre:"MANSILLA",   jerarquia:"Sargento 1춿",        guardias:"24x48",       disponibilidad:"disponible", notas:"Guardias: 2,5,8,11,14,17,20,23,26,29. El 18 solo noche." },
            { nombre:"CIRIGLIANO", jerarquia:"Sargento 1춿",        guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir pares. Del 1 al 6 curso SYC. 7 votaci칩n. 20 capacitaci칩n." },
            { nombre:"LOPEZ",      jerarquia:"Ayudante",           guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir pares. No el 12, lunes, mi칠rcoles y jueves." },
            { nombre:"ALEGRE",     jerarquia:"Cabo",               guardias:"12x36 IMPAR", disponibilidad:"disponible", notas:"Puede cubrir pares. No el 12, lunes, mi칠rcoles y jueves." },
            { nombre:"GONZALEZ L", jerarquia:"Suboficial Auxiliar",guardias:"24x48",       disponibilidad:"disponible", notas:"Guardias: 2-5-8-11-14-17-20-23-26-29." }
        ];

        const personalChoferesData = [
            { nombre:"ALMIRON",   jerarquia:"Chofer", guardias:"CUSTODIA 1", disponibilidad:"disponible", notas:"Asignado a custodia Sra. Amalia. D칤as libres: 6, 13-30." },
            { nombre:"ROBLEDO",   jerarquia:"Chofer", guardias:"CUSTODIA 2", disponibilidad:"disponible", notas:"Asignado a custodia Isabella. Guardias: 3-6-9-12-15-18-21-24-27-30." },
            { nombre:"FERNANDEZ", jerarquia:"Chofer", guardias:"CUSTODIA 1", disponibilidad:"disponible", notas:"Asignado a custodia Sra. Amalia. Guardias: 1-4-7-10-13-16-19-22-25-28." },
            { nombre:"FERRER",    jerarquia:"Chofer", guardias:"CUSTODIA 2", disponibilidad:"disponible", notas:"Asignado a custodia Isabella. Guardias: 1-4-7-10-13-16-19-22-25-28." },
            { nombre:"PAZ",       jerarquia:"Chofer", guardias:"CUSTODIA 3", disponibilidad:"disponible", notas:"Asignado a custodia Angelina. Guardias: 2-5-8-11-14-17-20-23-26-29. Libre: 6." },
            { nombre:"PIANELLI",  jerarquia:"Chofer", guardias:"CUSTODIA 2", disponibilidad:"disponible", notas:"Asignado a custodia Isabella. D칤as libres: 6, 13-30." },
            { nombre:"CHARON",    jerarquia:"Chofer", guardias:"CUSTODIA 1", disponibilidad:"disponible", notas:"Asignado a custodia Sra. Amalia. Guardias: 3-6-9-12-15-18-21-24-27-30." },
            { nombre:"CARRE칌O",   jerarquia:"Chofer", guardias:"CUSTODIA 3", disponibilidad:"disponible", notas:"Asignado a custodia Angelina. Guardias: 1-4-7-10-13-16-19-22-25-28." },
            { nombre:"ACOSTA",    jerarquia:"Chofer", guardias:"CUSTODIA 4", disponibilidad:"disponible", notas:"Asignado a custodia Valentino. Guardias: 2-5-8-11-14-17-20-23-26-29. 12x36 PARES L a V." },
            { nombre:"ACEVEDO",   jerarquia:"Chofer", guardias:"CUSTODIA 4", disponibilidad:"disponible", notas:"Asignado a custodia Valentino. 12x36 IMPARES L a V." },
            { nombre:"FURFARO",   jerarquia:"Chofer", guardias:"CUSTODIA 4", disponibilidad:"disponible", notas:"Asignado a custodia Valentino. 12x36 IMPARES L a V." },
            { nombre:"NARVAEZ",   jerarquia:"Chofer", guardias:"CUSTODIA 3", disponibilidad:"disponible", notas:"Asignado a custodia Angelina. Guardias: 2-5-8-11-14-17-20-23-26-29." }
        ];

        const coverageData = [
            { semana:"1 (1-7)",  diasCubiertos:"7/7", incidentes:0, acciones:"Ninguna" },
            { semana:"2 (8-14)", diasCubiertos:"6/7", incidentes:1, acciones:"Cubrir d칤a 12 (turno noche)" },
            { semana:"3 (15-21)",diasCubiertos:"7/7", incidentes:0, acciones:"Ninguna" },
            { semana:"4 (22-30)",diasCubiertos:"6/7", incidentes:2, acciones:"Cubrir d칤as 27 y 28" }
        ];

        const importantNotes = [
            "El d칤a 12 se necesita refuerzo en turno noche",
            "SCARSO tiene licencia del 29/09 al 06/10",
            "VIZGARRA cursa formaci칩n los lunes, mi칠rcoles y ma침anas",
            "El d칤a 18 LOBO solo est치 disponible para turno noche",
            "Los d칤as 27 y 28 necesitan cobertura adicional",
            "D칤as 17-30: Asignaci칩n de supervisores pendiente"
        ];

        let editMode = false;

        // Funci칩n para cambiar entre pesta침as principales
        function openTab(evt, tabName) {
            var i, tabcontent, tabs;
            
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            tabs = document.getElementsByClassName("tab");
            for (i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Funci칩n para cambiar entre sub-pesta침as de personal
        function openSubTab(evt, subTabName) {
            var i, subTabcontent, subTabs;
            
            subTabcontent = document.getElementsByClassName("sub-tab-content");
            for (i = 0; i < subTabcontent.length; i++) {
                subTabcontent[i].classList.remove("active");
            }
            
            subTabs = document.getElementsByClassName("sub-tab");
            for (i = 0; i < subTabs.length; i++) {
                subTabs[i].classList.remove("active");
            }
            
            document.getElementById(subTabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Funci칩n para cargar la tabla de turnos (AHORA incluye Chofer de Apoyo)
        function loadTurnosTable() {
            const tableBody = document.querySelector("#turnos-table tbody");
            tableBody.innerHTML = ''; // Limpiar tabla antes de cargar
            
            turnosData.forEach(dia => {
                const row = document.createElement("tr");
                
                // Resaltar filas con supervisor por asignar
                if (dia.supervisor === "Por asignar") {
                    row.style.backgroundColor = "#fff8e1";
                }
                
                row.innerHTML = `
                    <td>\${dia.dia}</td>
                    <td>\${dia.fecha}</td>
                    <td class="turno-ma침ana editable" contenteditable="false">\${dia.ma침ana1}</td>
                    <td class="turno-ma침ana editable" contenteditable="false">\${dia.ma침ana2}</td>
                    <td class="turno-noche editable" contenteditable="false">\${dia.noche1}</td>
                    <td class="turno-noche editable" contenteditable="false">\${dia.noche2}</td>
                    <td class="turno-especial editable" contenteditable="false">\${dia.especial}</td>
                    <td class="turno-refuerzo editable" contenteditable="false">\${dia.apoyo || ""}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci칩n para cargar la tabla de choferes
        function loadChoferesTable() {
            const tableBody = document.querySelector("#choferes-table tbody");
            tableBody.innerHTML = ''; // Limpiar tabla antes de cargar
            
            choferesData.forEach(dia => {
                const row = document.createElement("tr");
                
                row.innerHTML = `
                    <td>\${dia.dia}</td>
                    <td>\${dia.fecha}</td>
                    <td class="turno-refuerzo editable" contenteditable="false">\${dia.custodia1}</td>
                    <td class="turno-refuerzo editable" contenteditable="false">\${dia.custodia2}</td>
                    <td class="turno-refuerzo editable" contenteditable="false">\${dia.custodia3}</td>
                    <td class="turno-refuerzo editable" contenteditable="false">\${dia.custodia4}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci칩n para cargar la tabla de personal de cabina
        function loadPersonalCabinaTable() {
            const tableBody = document.querySelector("#personal-cabina-table tbody");
            tableBody.innerHTML = ''; // Limpiar tabla antes de cargar
            
            personalCabinaData.forEach(persona => {
                const row = document.createElement("tr");
                
                const statusClass = persona.disponibilidad === "disponible" ? "status-disponible" : 
                                   persona.disponibilidad === "parcial" ? "status-parcial" : "status-no-disponible";
                
                const statusText = persona.disponibilidad === "disponible" ? "Disponible" : 
                                  persona.disponibilidad === "parcial" ? "Parcial" : "No disponible";
                
                row.innerHTML = `
                    <td><strong>\${persona.nombre}</strong></td>
                    <td class="editable" contenteditable="false">\${persona.jerarquia}</td>
                    <td class="editable" contenteditable="false">\${persona.guardias}</td>
                    <td><span class="status \${statusClass}">\${statusText}</span></td>
                    <td class="editable" contenteditable="false">\${persona.notas}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci칩n para cargar la tabla de personal de choferes
        function loadPersonalChoferesTable() {
            const tableBody = document.querySelector("#personal-choferes-table tbody");
            tableBody.innerHTML = ''; // Limpiar tabla antes de cargar
            
            personalChoferesData.forEach(persona => {
                const row = document.createElement("tr");
                
                const statusClass = persona.disponibilidad === "disponible" ? "status-disponible" : 
                                   persona.disponibilidad === "parcial" ? "status-parcial" : "status-no-disponible";
                
                const statusText = persona.disponibilidad === "disponible" ? "Disponible" : 
                                  persona.disponibilidad === "parcial" ? "Parcial" : "No disponible";
                
                row.innerHTML = `
                    <td><strong>\${persona.nombre}</strong></td>
                    <td class="editable" contenteditable="false">\${persona.jerarquia}</td>
                    <td class="editable" contenteditable="false">\${persona.guardias}</td>
                    <td><span class="status \${statusClass}">\${statusText}</span></td>
                    <td class="editable" contenteditable="false">\${persona.notas}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci칩n para cargar la tabla de cobertura
        function loadCoverageTable() {
            const tableBody = document.querySelector("#coverage-table tbody");
            tableBody.innerHTML = ''; // Limpiar tabla antes de cargar
            
            coverageData.forEach(semana => {
                const row = document.createElement("tr");
                
                // Resaltar filas con incidentes
                if (semana.incidentes > 0) {
                    row.style.backgroundColor = "#ffebee";
                }
                
                row.innerHTML = `
                    <td>\${semana.semana}</td>
                    <td>\${semana.diasCubiertos}</td>
                    <td>\${semana.incidentes}</td>
                    <td class="editable" contenteditable="false">\${semana.acciones}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Funci칩n para cargar las notas importantes
        function loadImportantNotes() {
            const notesList = document.getElementById("important-notes");
            notesList.innerHTML = ''; // Limpiar lista antes de cargar
            
            importantNotes.forEach(nota => {
                const listItem = document.createElement("li");
                listItem.textContent = nota;
                listItem.contentEditable = "false";
                listItem.className = "editable";
                notesList.appendChild(listItem);
            });
        }

        // Funci칩n para alternar el modo de edici칩n
        function toggleEditMode() {
            editMode = !editMode;
            const editables = document.querySelectorAll('.editable');
            const editIcon = document.getElementById('edit-icon');
            const editText = document.getElementById('edit-text');
            
            if (editMode) {
                editables.forEach(element => {
                    element.contentEditable = "true";
                    element.classList.add('edit-mode');
                });
                editIcon.textContent = '游';
                editText.textContent = 'Guardar';
            } else {
                editables.forEach(element => {
                    element.contentEditable = "false";
                    element.classList.remove('edit-mode');
                });
                editIcon.textContent = '九勇';
                editText.textContent = 'Editar';
                
                alert('Cambios guardados correctamente');
            }
        }

        // Funci칩n para exportar a PDF
        async function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            // Ocultar botones y elementos de edici칩n para el PDF
            const actionButtons = document.querySelector('.action-buttons');
            const originalDisplay = actionButtons.style.display;
            actionButtons.style.display = 'none';
            
            // Remover clases de edici칩n
            const editables = document.querySelectorAll('.editable');
            editables.forEach(element => {
                element.classList.remove('edit-mode');
            });
            
            // Capturar el contenido
            const content = document.getElementById('content-to-export');
            
            // Crear una copia del contenido para el PDF
            const contentCopy = content.cloneNode(true);
            
            // Estilos espec칤ficos para el PDF
            const pdfStyles = `
                <style>
                    body { font-family: Arial, sans-serif; }
                    .container { max-width: 100%; margin: 0; box-shadow: none; }
                    header { padding: 15px; }
                    h1 { font-size: 18px; margin-bottom: 5px; }
                    .legend { padding: 10px; }
                    .legend h2 { font-size: 14px; margin-bottom: 5px; }
                    .legend-item { font-size: 10px; }
                    .content { padding: 10px; }
                    table { width: 100%; border-collapse: collapse; font-size: 8px; }
                    th, td { padding: 5px; border: 1px solid #ddd; }
                    th { background-color: #1a3b5d; color: white; }
                    .turno-ma침ana { background-color: #e3f2fd; }
                    .turno-noche { background-color: #e8eaf6; }
                    .turno-especial { background-color: #e8f5e9; }
                    .turno-refuerzo { background-color: #fff3e0; }
                    .custodia-header { background-color: #1a3b5d; color: white; }
                    .summary-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0; }
                    .card { padding: 8px; border-left: 3px solid #3498db; }
                    .card h3 { font-size: 10px; margin-bottom: 5px; }
                    .card-value { font-size: 16px; font-weight: bold; color: #3498db; }
                    .card-desc { font-size: 8px; color: #7f8c8d; }
                    .notes { padding: 8px; margin-top: 10px; }
                    .notes h3 { font-size: 12px; margin-bottom: 5px; }
                    .notes li { font-size: 8px; margin-bottom: 3px; }
                    .alert { padding: 8px; margin: 10px 0; font-size: 9px; }
                    .tabs { display: none; }
                    .sub-tabs { display: none; }
                    .tab-content { display: block !important; }
                    .sub-tab-content { display: block !important; }
                    .tab-content:not(.active) { display: none !important; }
                </style>
            `;
            
            // Crear un elemento temporal para el PDF
            const tempElement = document.createElement('div');
            tempElement.innerHTML = pdfStyles;
            tempElement.appendChild(contentCopy);
            document.body.appendChild(tempElement);
            
            try {
                // Convertir a imagen
                const canvas = await html2canvas(tempElement, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    width: tempElement.scrollWidth,
                    height: tempElement.scrollHeight
                });
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 190; // Ancho en mm (A4 - m치rgenes)
                const pageHeight = 295; // Altura en mm (A4 - m치rgenes)
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 10;
                
                // Agregar la imagen al PDF
                pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Si el contenido es m치s largo que una p치gina, agregar m치s p치ginas
                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'PNG', 10, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }
                
                // Guardar el PDF
                const fileName = `Cronograma_Cabina_Septiembre_2025_\${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                // Mostrar mensaje de 칠xito
                alert('PDF generado correctamente: ' + fileName);
                
            } catch (error) {
                console.error('Error al generar PDF:', error);
                alert('Error al generar el PDF. Por favor, intente nuevamente.');
            } finally {
                // Restaurar la vista original
                document.body.removeChild(tempElement);
                actionButtons.style.display = originalDisplay;
            }
        }

        // Inicializar la aplicaci칩n cuando el DOM est칠 cargado
        document.addEventListener("DOMContentLoaded", function() {
            loadTurnosTable();
            loadChoferesTable();
            loadPersonalCabinaTable();
            loadPersonalChoferesTable();
            loadCoverageTable();
            loadImportantNotes();
        });
    </script>
</body>
</html>
"""
with open('/mnt/data/cronograma_apoyo.html', 'w', encoding='utf-8') as f:
    f.write(html)
print("Archivo generado en /mnt/data/cronograma_apoyo.html")
